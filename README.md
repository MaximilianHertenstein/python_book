# Python Book

A Python learning book built with mdBook and interactive quizzes.

## Setup

This project uses:
- **mdBook v0.4.45** - for building the book
- **mdbook-quiz v0.4.0** - for interactive quiz support

## Important: Version Compatibility

**mdbook-quiz v0.4.0 requires mdBook v0.4.45**, not the latest v0.5.x. This is a known incompatibility - see [mdbook-quiz issue #61](https://github.com/cognitive-engineering-lab/mdbook-quiz/issues/61).

### Installation

Install the required versions:

```bash
# Install mdBook v0.4.45
cargo install mdbook --version 0.4.45 --locked

# Install mdbook-quiz v0.4.0
cargo install mdbook-quiz --version 0.4.0 --locked

# Install mdbook-admonish v1.20.0
cargo install mdbook-admonish --version 1.20.0 --locked
```

### NPM Dependencies

Install the Node.js dependencies for Thebe support:

```bash
npm install
```

Then copy the Thebe build artifacts to the project:

```bash
npx copy-thebe-assets src/thebe
```

This needs to be done once during setup and again if you update Thebe packages.

## Building

To build the book, use either:

```bash
# Using npm
npm run build

# Or directly with mdbook
mdbook build
```

To serve the book locally with live reload:

```bash
# Using npm
npm run serve

# Or directly with mdbook
mdbook serve
```

The built book will be in the `book/` directory.

## Project Structure

```
src/
├── chapter_1.md      # Chapter 1 with example quiz
├── chapter_2.md      # Chapter 2
├── SUMMARY.md        # Table of contents
├── quizzes/
│   └── python-basics.toml  # Example quiz file
├── quiz/             # Quiz UI assets (generated by mdbook-quiz)
├── thebe/            # Thebe assets (for interactive code execution)
└── book_theme/       # Custom mdBook theme
```

## Quizzes

Quizzes are stored in `src/quizzes/` as TOML files and referenced in markdown using:

```markdown
{{#quiz python-basics.toml}}
```

### Quiz Format

Quizzes support multiple question types:

#### Short Answer
```toml
[[questions]]
type = "ShortAnswer"
prompt.prompt = "What is the output of 1 + 1 in Python?"
answer.answer = "2"
context = "Basic arithmetic in Python"
```

#### Multiple Choice
```toml
[[questions]]
type = "MultipleChoice"
prompt.prompt = "What keyword declares a variable?"
prompt.distractors = ["var", "def", "class"]
answer.answer = "let"
context = "In Python, variables are assigned directly without keywords"
```

For more quiz formats, see the [mdbook-quiz documentation](https://github.com/cognitive-engineering-lab/mdbook-quiz#quiz-schema).

## Admonitions

This book uses [mdbook-admonish](https://github.com/tommilligan/mdbook-admonish) to add callout boxes for notes, warnings, tips, and other admonitions.

### Usage

Use admonitions in your markdown with the following syntax:

```markdown
> [!NOTE]
> This is a note

> [!WARNING]
> This is a warning

> [!TIP]
> This is a tip

> [!IMPORTANT]
> This is important

> [!CAUTION]
> Be careful!
```

Supported types: `NOTE`, `ABSTRACT`, `INFO`, `TIP`, `SUCCESS`, `QUESTION`, `WARNING`, `FAILURE`, `DANGER`, `BUG`, `EXAMPLE`, `QUOTE`

See the [mdbook-admonish documentation](https://github.com/tommilligan/mdbook-admonish) for more details.

## Thebe (Interactive Code Execution)

This book supports interactive Python code execution through [Thebe](https://thebe.readthedocs.io/). Code blocks in the book can be executed directly in the browser.

### Thebe Setup



**If you've modified Thebe packages**, rebuild the assets:

```bash
npx copy-thebe-assets src/thebe
```

Then rebuild the book:

```bash
npm run build
```

## GitHub Actions / CI/CD Setup

To build this book in GitHub Actions or other CI/CD systems, you need to install both mdBook and mdbook-quiz.

### GitHub Actions Workflow Example

Add this to your `.github/workflows/build.yml`:

```yaml
name: Build Book

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install Rust
      uses: actions-rs/toolchain@v1
      with:
        toolchain: stable
    
    - name: Install mdBook
      run: cargo install mdbook --version 0.4.52 --locked
    
    - name: Install mdbook-quiz
      run: cargo install mdbook-quiz --locked
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
    
    - name: Install npm dependencies
      run: npm install
    
    - name: Copy Thebe assets
      run: npx copy-thebe-assets book/thebe
    
    - name: Build book
      run: npm run build
    
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v2
      with:
        path: 'book'
```

**Key steps:**
- Install mdBook v0.4.45 (not the latest version)
- Install mdbook-quiz
- Install npm dependencies
- Copy Thebe assets
- Build the book

## Troubleshooting

### "Unable to parse the input" error

This typically means you're using mdBook v0.5.x with mdbook-quiz v0.4.0. **Downgrade to mdBook v0.4.45**:

```bash
cargo install mdbook --version 0.4.45 --locked
```

### Quiz not rendering

- Ensure the quiz file path is relative to the markdown file: `{{#quiz ../quizzes/quiz-name.toml}}`
- Check that the TOML file is valid (no syntax errors)
- Verify the quiz file exists in `src/quizzes/`

### GitHub Actions: mdbook-quiz not found

If you get `The command 'mdbook-quiz' wasn't found` in GitHub Actions, make sure your workflow installs mdbook-quiz before building:

```yaml
- name: Install mdbook-quiz
  run: cargo install mdbook-quiz --locked
```

See the [GitHub Actions / CI/CD Setup](#github-actions--cicd-setup) section above for a complete workflow example.
